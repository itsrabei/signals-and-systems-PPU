\documentclass{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{float}
\usepackage{subcaption}
\usepackage{geometry}

\geometry{a4paper, margin=1in}

% Define example environment
\newenvironment{example}[1]{
    \begin{trivlist}
    \item[\textbf{Example:}] #1
    \vspace{0.5em}
}{
    \end{trivlist}
    \vspace{1em}
}

\pgfplotsset{compat=1.18}
\usetikzlibrary{patterns,decorations.pathreplacing}

\title{Lecture 4 Examples}
\author{Signals and Systems Course}
\date{}

\begin{document}

\maketitle

\begin{example}[1. Discrete-Time Convolution: Exponential and Unit Step]
\textbf{Problem:}
Find the convolution $y[n] = x[n] * h[n]$ where:
\begin{align}
    x[n] &= a^n u[n], \quad |a| < 1 \\
    h[n] &= u[n]
\end{align}

\begin{figure}[H]
	\centering
	\begin{minipage}{0.45\textwidth}
		\centering
		% Scale to a fixed height of 5cm, width is automatic
		\resizebox{!}{5cm}{\input{figures/lec04_examples/exponential_signal.tex}}
		\caption{Input signal $x[n] = a^n u[n]$}
	\end{minipage}\hfill
	\begin{minipage}{0.45\textwidth}
		\centering
		% Scale to the SAME fixed height
		\resizebox{!}{5cm}{\input{figures/lec04_examples/unit_step.tex}}
		\caption{Impulse response $h[n] = u[n]$}
	\end{minipage}
\end{figure}
\textbf{Solution:}

$$y[n] = \sum_{k=-\infty}^{\infty} x[k] h[n-k] = \sum_{k=0}^{n} a^k = \frac{1 - a^{n+1}}{1 - a}$$

For $n < 0$: $y[n] = 0$

\textbf{Answer:}
$$y[n] = \frac{1 - a^{n+1}}{1 - a} u[n]$$

\begin{figure}[H]
    \centering
    \input{figures/lec04_examples/convolution_result.tex}
    \caption{Result of convolution $y[n] = x[n] * h[n]$}
\end{figure}
\end{example}

\vspace{0.5em}
\hrule
\vspace{0.5em}

\begin{example}[2. Convolution of Two Exponential Sequences]
\textbf{Problem:}
Find the convolution $y[n] = x[n] * h[n]$ where:
\begin{align}
    x[n] &= a^n u[n], \quad |a| < 1 \\
    h[n] &= b^n u[n], \quad |b| < 1
\end{align}

\textbf{Solution:}

$$y[n] = \sum_{k=0}^{n} a^k b^{n-k} = b^n \sum_{k=0}^{n} \left(\frac{a}{b}\right)^k$$

\textbf{Case 1:} $a \neq b$
$$y[n] = b^n \frac{1 - \left(\frac{a}{b}\right)^{n+1}}{1 - \frac{a}{b}} = \frac{b^{n+1} - a^{n+1}}{b - a}$$

\textbf{Case 2:} $a = b$
$$y[n] = a^n (n + 1)$$

\textbf{Answer:}
$$y[n] = \begin{cases}
    \frac{b^{n+1} - a^{n+1}}{b - a} u[n] & \text{if } a \neq b \\
    a^n (n + 1) u[n] & \text{if } a = b
\end{cases}$$
\end{example}

\vspace{0.5em}
\hrule
\vspace{0.5em}

\begin{example}[3. Convolution of Right-Sided and Left-Sided Signals]
\textbf{Problem:}
Find the convolution $y[n] = x[n] * h[n]$ where:
\begin{align}
    x[n] &= u[n] \\
    h[n] &= \left(\frac{1}{2}\right)^n u[n]
\end{align}

\textbf{Solution:}

$$y[n] = \sum_{k=0}^{n} \left(\frac{1}{2}\right)^{n-k} = \left(\frac{1}{2}\right)^n \sum_{k=0}^{n} 2^k = \left(\frac{1}{2}\right)^n \frac{2^{n+1} - 1}{2 - 1} = 2 - 2^{-n}$$

For $n < 0$: $y[n] = 0$

\textbf{Answer:}
$$y[n] = (2 - 2^{-n}) u[n]$$
\end{example}

\vspace{0.5em}
\hrule
\vspace{0.5em}

\begin{example}[4. Finite-Duration Convolution]
\textbf{Problem:}
Find the convolution $y[n] = x[n] * h[n]$ where:
\begin{align}
    x[n] &= \begin{cases}
        1 & \text{for } 0 \leq n \leq 2 \\
        0 & \text{otherwise}
    \end{cases} \\
    h[n] &= \begin{cases}
        n & \text{for } 0 \leq n \leq 2 \\
        0 & \text{otherwise}
    \end{cases}
\end{align}

\begin{figure}[H]
	\centering
	\begin{minipage}{0.45\textwidth}
		\centering
		% Scale to a fixed height, width will adjust automatically
		\resizebox{!}{5cm}{\input{figures/lec04_examples/finite_x.tex}}
		\caption{Input signal $x[n]$}
	\end{minipage}\hfill
	\begin{minipage}{0.45\textwidth}
		\centering
		% Scale to the SAME fixed height
		\resizebox{!}{5cm}{\input{figures/lec04_examples/finite_h.tex}}
		\caption{Impulse response $h[n]$}
	\end{minipage}
\end{figure}
\textbf{Solution:}

For each $n$, sum over the overlap region $\max(0, n-2) \leq k \leq \min(2, n)$:

\begin{align}
y[0] &= 0 \\
y[1] &= 1 \cdot 1 = 1 \\
y[2] &= 1 \cdot 2 + 1 \cdot 1 + 1 \cdot 0 = 3 \\
y[3] &= 1 \cdot 2 + 1 \cdot 1 = 3 \\
y[4] &= 1 \cdot 2 = 2
\end{align}

\textbf{Answer:}
$$y[n] = \begin{cases}
    0 & \text{for } n < 0 \text{ or } n > 4 \\
    1 & \text{for } n = 1 \\
    3 & \text{for } n = 2, 3 \\
    2 & \text{for } n = 4
\end{cases}$$

\begin{figure}[H]
    \centering
    \input{figures/lec04_examples/finite_convolution.tex}
    \caption{Result of convolution $y[n] = x[n] * h[n]$}
\end{figure}
\end{example}

\vspace{0.5em}
\hrule
\vspace{0.5em}

\begin{example}[5. Convolution of Two Finite-Length Sequences]
\textbf{Problem:}
Find $y[n] = x[n] * h[n]$ where:
\[ h[n] = \begin{cases} 1 & n=0 \\ -1/2 & n=1 \\ 0 & \text{otherwise} \end{cases} \]
\[ x[n] = \begin{cases} 1 & n=-1 \\ 2 & n=0 \\ -1 & n=1 \\ 0 & \text{otherwise} \end{cases} \]

\begin{figure}[H]
    \centering
    \input{figures/lec04_examples/finite_length_input.tex}
    \caption{The finite-length input signal $x[k]$.}
\end{figure}

\textbf{Solution:}
$y[n]$ is non-zero for $n \in \{-1, 0, 1, 2\}$:

\begin{align}
y[-1] &= x[-1]h[0] = (1)(1) = 1 \\
y[0] &= x[-1]h[1] + x[0]h[0] = (1)(-1/2) + (2)(1) = 3/2 \\
y[1] &= x[0]h[1] + x[1]h[0] = (2)(-1/2) + (-1)(1) = -2 \\
y[2] &= x[1]h[1] = (-1)(-1/2) = 1/2
\end{align}

\textbf{Alternative:} Decompose $x[n] = \delta[n+1] + 2\delta[n] - \delta[n-1]$
Then $y[n] = h[n+1] + 2h[n] - h[n-1]$ gives same result.

\begin{figure}[H]
    \centering
    \input{figures/lec04_examples/finite_length_output.tex}
    \caption{The final output signal $y[n]$.}
\end{figure}

\textbf{Answer:} $y[n] = \{1, 3/2, -2, 1/2\}$ for $n = \{-1, 0, 1, 2\}$, 0 otherwise
\end{example}

\end{document}